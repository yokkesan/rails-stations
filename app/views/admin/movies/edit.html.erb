<h1>映画情報を編集</h1>

<% if flash[:alert] %>
  <p style="color: red;"><%= flash[:alert] %></p>
<% end %>

<% if @movie.errors.any? %>
  <div style="color: red;">
    <p>入力エラーがあります:</p>
    <ul>
      <% @movie.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<%= form_with model: @movie, url: admin_movie_path(@movie), method: :put do |f| %>
  <div>
    <label>タイトル:</label>
    <%= f.text_field :name, required: true %>
  </div>

  <div>
    <label>公開年:</label>
    <%= f.text_field :year %>
  </div>

  <div>
    <label>概要:</label>
    <%= f.text_area :description %>
  </div>

  <div>
    <label>画像URL:</label>
    <%= f.text_field :image_url %>
  </div>

  <div>
    <label>上映中:</label>
    <%= f.check_box :is_showing %>
  </div>

  <div>
    <%= f.submit "更新" %>
  </div>
<% end %>

<!-- 削除ボタン -->
<%= button_to "削除", admin_movie_path(@movie), method: :delete, data: { confirm: "本当に削除しますか？" }, class: "delete-button" %>

<%= link_to "映画一覧に戻る", admin_movies_path %>

<h2>上映スケジュール管理</h2>

<% if @movie.schedules.any? %>
  <ul>
    <% @movie.schedules.each do |schedule| %>
      <li>
        <%= schedule.start_time.strftime("%H:%M") %> 〜 <%= schedule.end_time.strftime("%H:%M") %>
        <%= link_to "編集", admin_schedule_path(schedule) %>
      </li>
    <% end %>
  </ul>
<% else %>
  <p>現在スケジュールが登録されていません。</p>
<% end %>

<%= link_to "新しいスケジュールを追加", new_admin_movie_schedule_path(@movie), class: "btn btn-primary" %>